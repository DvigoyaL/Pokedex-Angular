<div class="min-h-screen">
  <!-- Mobile Filter Toggle Button (visible only on mobile) -->
  <button
    (click)="toggleFilterPanel()"
    class="fixed bottom-6 right-6 z-40 lg:hidden bg-yellow-400 text-white p-4 rounded-full shadow-lg hover:bg-yellow-500 transition"
    style="background-color: #fbc02d;"
  >
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
    </svg>
  </button>

  <!-- Overlay (mobile only) -->
  @if (isFilterPanelOpen) {
    <div
      class="fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden"
      (click)="closeFilterPanel()"
    ></div>
  }

  <!-- Sidebar with Filters -->
  <aside
    [class.translate-x-0]="isFilterPanelOpen"
    [class.-translate-x-full]="!isFilterPanelOpen"
    class="fixed top-0 lg:top-16 left-0 w-80 bg-white border-r border-gray-200 overflow-y-auto h-screen lg:h-[calc(100vh-4rem)] z-50 lg:z-10 transition-transform duration-300 lg:translate-x-0"
  >
    <!-- Close button (mobile only) -->
    <button
      (click)="closeFilterPanel()"
      class="absolute top-4 right-4 lg:hidden text-gray-600 hover:text-gray-800 z-10"
    >
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>

    <app-filter-panel (filterChange)="onFilterChange($event)"></app-filter-panel>
  </aside>

  <!-- Main Content -->
  <main class="lg:ml-80 lg:pt-16 flex-1">
    <!-- Loading State -->
    @if (isLoading && isInitialLoad) {
      <div class="text-center my-8">
        <p class="text-xl text-gray-600">Loading Pokémon...</p>
      </div>
    }

    <!-- Error Message -->
    @if (error) {
      <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mx-8 mt-4">
        <p class="font-medium">{{ error }}</p>
      </div>
    }

    <!-- Results -->
    @if (!isLoading || !isInitialLoad) {
      @if (displayedPokemonList.length > 0) {
        <ul class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-7 gap-4 p-8">
          @for (pokemon of displayedPokemonList; track pokemon.id) {
            <pokedex-pokemon-basic-card
              [pokemon]="pokemon"
              [backgroundColor]="getColorForType(pokemon.types[0].type.name)"
              (cardClicked)="selectPokemon($event)"
            />
          }
        </ul>

        <!-- Navigation Buttons -->
        <pokedex-pokemon-navigationButtons
          [offset]="currentPage * itemsPerPage"
          [isLoading]="isLoading"
          (previousClicked)="onPreviousPage()"
          (nextClicked)="onNextPage()"
        />
      } @else {
        <div class="text-center py-20">
          <p class="text-xl text-gray-600">No Pokémon found with the selected filters</p>
        </div>
      }
    }
  </main>
</div>

<!-- Modal for Pokemon Details -->
@if (selectedPokemon) {
  <pokedex-pokemon-modal-card
    [pokemon]="selectedPokemon"
    [pokemonList]="displayedPokemonList"
    (modalClosed)="closeModal()"
    (pokemonSelected)="selectPokemon($event)"
  />
}

